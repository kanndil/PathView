# PathView

<div align="center">

  <a href="">[![Github Pages](https://img.shields.io/badge/github%20pages-121013?style=for-the-badge&logo=github&logoColor=white)](https://kanndil.github.io/PathView/)</a>

</div>

<div align="center">

  <a href="">[![code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)</a>
  <a href="">[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)</a>

</div>


## Table of contents

* [Overview](#-overview)
* [File structure](#file-structure)
* [Dependencies](#-dependencies)
* [How to use](#-how-to-use)
* [Examples](#examples)
* [Authors](#authors)
* [Copyright and Licensing](#%EF%B8%8F-copyright-and-licensing)
<br/><br/>

# ğŸ“– Overview

Extracts the paths generated by [OpenSTA](https://github.com/The-OpenROAD-Project/OpenSTA) reports and uses [netlistsvg](https://github.com/nturley/netlistsvg) to produce interactive SVG schematics for the extracted paths. The produced schematics interactively show the timing details of each cell for any standard cell library. Sky130_fd_sc_hd is supported as the default standard cell library, however, to add other libraries check [Support the standard cell library you are using](https://github.com/kanndil/PathView#second-support-the-standard-cell-library-you-are-using).
<br/><br/>

# File structure
  
    .
    â”œâ”€â”€ LICENSE
    â”œâ”€â”€ README.md
    â”œâ”€â”€ demo_html
    â”‚Â Â  â”œâ”€â”€ path0.html
    â”‚Â Â  â”œâ”€â”€ path1.html
    â”‚Â Â  â””â”€â”€ path2.html
    â”œâ”€â”€ index.html
    â”œâ”€â”€ liberty
    â”‚Â Â  â”œâ”€â”€ gf180mcu_fd_sc_mcu7t5v0__tt_025C_5v00.lib
    â”‚Â Â  â””â”€â”€ sky130_fd_sc_hd.lib
    â”œâ”€â”€ representations
    â”œâ”€â”€ skinFiles
    â”‚Â Â  â”œâ”€â”€ gf180mcu_fd_sc_mcu7t5v0__tt_025C_5v00_representations
    â”‚Â Â  â”‚Â Â  â””â”€â”€ default.svg
    â”‚Â Â  â”œâ”€â”€ sky130_default_representations
    â”‚Â Â  â”‚Â Â  â””â”€â”€ default.svg
    â”‚Â Â  â””â”€â”€ sky130_fd_sc_hd_representations
    â”‚Â Â      â””â”€â”€ default.svg
    â”œâ”€â”€ src
    â”‚Â Â  â”œâ”€â”€ generateSkinFile.py
    â”‚Â Â  â””â”€â”€ interactiveReport.py
    â”œâ”€â”€ sta_reports
    â”œâ”€â”€ supportedCells.txt
    â””â”€â”€ testDesigns

<br/><br/>

# ğŸ§± Dependencies


<details>
  <summary>For macos</summary>


## Install python3.6+
- Get homebrew

        /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

- Install python using homebrew

        export PATH="/usr/local/opt/python/libexec/bin:$PATH"
        brew install python3

## Install pip dependancies

        pip3 install pyeda
        pip3 install sympy
        pip3 install liberty-parser


## Install OpenSTA

- Install OpenSTA  

You can find the installation steps in [OpenSTA installation](https://github.com/The-OpenROAD-Project/OpenSTA).


## Install netlistsvg

To install the latest version from source:
```sh
git clone https://github.com/nturley/netlistsvg
cd netlistsvg
npm install # install dependencies
sudo npm install -g . # install netlistsvg to system

sudo npm uninstall -g netlistsvg # uninstall from system
```
</details>

<details>
  <summary>For Linux</summary>

## Install Conda for package installation

    bash Miniconda3-latest-Linux-x86_64.sh

## Use  Conda to install all dependencies

    conda install -y -c litex-hub -c conda-forge python

## Install pip dependancies

        pip3 install pyeda
        pip3 install sympy
        pip3 install liberty-parser

## Install OpenSTA

- Install OpenSTA  

        conda install -y -c litex-hub -c conda-forge openroad

    or

    You can find the installation steps in [OpenSTA installation](https://github.com/The-OpenROAD-Project/OpenSTA).


## Install netlistsvg

To install the latest version from source:
```sh
git clone https://github.com/nturley/netlistsvg
cd netlistsvg
npm install # install dependencies
sudo npm install -g . # install netlistsvg to system

sudo npm uninstall -g netlistsvg # uninstall from system
```
</details>

<details>
  <summary>For Windows-10</summary>

## Install python3.6+
Install using the executable installer [here](https://www.python.org/downloads/windows/)

## Install pip dependancies

        pip3 install pyeda
        pip3 install sympy
        pip3 install liberty-parser

## Install OpenSTA

- Install OpenSTA  

You can find the installation steps in [OpenSTA installation](https://github.com/The-OpenROAD-Project/OpenSTA).


## Install netlistsvg

To install the latest version from source:
```sh
git clone https://github.com/nturley/netlistsvg
cd netlistsvg
npm install # install dependencies
sudo npm install -g . # install netlistsvg to system

sudo npm uninstall -g netlistsvg # uninstall from system
```
</details>
<br/><br/>

# ğŸ” How to use

## First: Generate the timing report using [OpenSTA](https://github.com/The-OpenROAD-Project/OpenSTA)

It is necessary to include the following feilds in the report_checks command:

    -fields {slew cap input_pins nets fanout}

For example:

    report_checks -path_delay min_max -format full_clock_expanded -fields {slew cap input_pins nets fanout}  -endpoint_count 10 -unique_paths_to_endpoint > ./sta_report.rpt

Here is a part of an example STA report: (Your report must have a similar format!)

    Fanout     Cap    Slew   Delay    Time   Description
    -----------------------------------------------------------------------------
                            12.50   12.50   clock clk' (rise edge)
                            0.00   12.50   clock source latency
                    2.00    0.00   12.50 v clock (in)
        1    1.05                           clock (net)
                    2.00    0.00   12.50 v padframe/clock_pad/PAD (sky130_ef_io__gpiov2_pad_wrapped)
        0    1.05                           clock (net)
                    0.06    1.38   13.88 v padframe/clock_pad/IN (sky130_ef_io__gpiov2_pad_wrapped)
        1    0.00                           clock_core (net)
                    0.06    0.00   13.88 v flash_clkrst_buffers/BUF[2]/A (sky130_fd_sc_hd__clkbuf_8)
                    0.08    0.12   14.00 v flash_clkrst_buffers/BUF[2]/X (sky130_fd_sc_hd__clkbuf_8)
        4    0.17                           clock_core_buf (net)

<br/><br/>

## Second: Support the standard cell library you are using

### First: Clone the repo

    git clone https://github.com/kanndil/PathView.git

### Second: Generate Skin-File

<details>
  <summary>Check these pre-generated skin-files</summary>

* [sky130_fd_sc_hd](https://github.com/kanndil/PathView/blob/1e3ac1b9517269c97a6a94d829ca40cedc8273f3/skinFiles/sky130_fd_sc_hd_representations/default.svg)
* [gf180mcu_fd_sc_mcu7t5v0__tt_025C_5v00](https://github.com/kanndil/PathView/blob/1e3ac1b9517269c97a6a94d829ca40cedc8273f3/skinFiles/gf180mcu_fd_sc_mcu7t5v0__tt_025C_5v00_representations/default.svg#L16)

</details>
<br/><br/>

To generate a new skin file for your standard cell library run the following command. The skin file will be located in [this](https://github.com/kanndil/PathView/blob/1e3ac1b9517269c97a6a94d829ca40cedc8273f3/skinFiles) directory.

Run:

    cd src/
    python3 generateSkinFile.py -i <libertyFilePath>
    
<br/><br/>


## Third: Generate the HTML interactive schematics


Run

    cd src/
    python3 interactiveReport.py -i <staReportFilePath> -s <skinFilePath> -n <numberOfPaths> --sort=<asc/desc>

Options:

    -n <numberOfPaths>

                        This option is used to specify the number of paths to be
                        generated. If this option is not specified, all paths are
                        generated.
                        
    --sort=<asc/desc>
                        This option is used to sort the paths in ascending 
                        or descending order based on slack. Use "asc" for 
                        ascending and "desc" for descending order.
                        

<br/><br/>

# Examples

For interactive examples check this [Demo](https://kanndil.github.io/PathView/)

<a href="https://kanndil.github.io/PathView/"><img src="https://github.com/kanndil/PathView/blob/main/images/websitePreview.png" alt="website preview" width="600"/></a>


<br/><br/>


# Authors

* [Mohamed Shalan](https://github.com/shalan)
* [Youssef Kandil](https://github.com/kanndil)
<br/><br/>

# âš–ï¸ Copyright and Licensing

Copyright 2023 AUC Open Source Hardware Lab

Licensed under the Apache License, Version 2.0 (the "License"); 
you may not use this file except in compliance with the License. 
You may obtain a copy of the License at:

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software 
distributed under the License is distributed on an "AS IS" BASIS, 
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
See the License for the specific language governing permissions and 
limitations under the License.
<br/><br/>